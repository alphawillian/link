(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{PRiR:function(t,e,s){"use strict";var i=s("nxHv"),r=s.n(i);r.a},Qhxy:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:["address-home",{"search-status":t.isShowSearchBlock}]},[s("div",{class:["block-top"]},[s("div",{staticClass:"top-line line1"},[s("span",{directives:[{name:"show",rawName:"v-show",value:!t.isShowSearchBlock,expression:"!isShowSearchBlock"}],staticClass:"line-left",on:{click:t.goAddressCity}},[s("i",{staticClass:"icon-location"}),s("span",{staticClass:"select-city"},[t._v(t._s(t.confirmedAddressInfo.cityInfo.cityName))]),s("i",{staticClass:"icon-down"})]),s("div",{staticClass:"input-block line-right"},[s("i",{staticClass:"icon-search"}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchTxt,expression:"searchTxt"}],ref:"addressInput",attrs:{type:"search",placeholder:"搜索城市范围内的地理位置"},domProps:{value:t.searchTxt},on:{focus:t.addressInputFocus,input:function(e){e.target.composing||(t.searchTxt=e.target.value)}}})]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowSearchBlock,expression:"isShowSearchBlock"}],staticClass:"search-btn",on:{click:t.doSearchAddress}},[t._v("搜索")])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShowSearchBlock,expression:"!isShowSearchBlock"}],staticClass:"main-block"},[s("div",{staticClass:"top-line line2"},[s("span",{staticClass:"line-left",on:{click:t.confirmLocation}},[t._v(t._s(t.gpsStreetTxt))]),s("span",{staticClass:"line-right",on:{click:function(e){t.getLatLng(1)}}},[s("i",{staticClass:"icon-resetLocation"}),s("span",[t._v("重新定位")])])]),t.localStorageArr.length?s("div",{staticClass:"block-history"},[s("div",{staticClass:"title"},[s("span",{staticClass:"title-left"},[t._v("历史搜索")]),s("span",{staticClass:"title-right",on:{click:t.delLocalStorageInfo}},[t._v("清除全部")])]),s("ul",{staticClass:"history-list"},[t._l(t.localStorageArr,function(e,i){return[e&&e.cityInfo&&e.addressInfo&&e.addressInfo.addressTxt?s("li",{key:i,staticClass:"item",on:{click:function(s){t.confirmLocalAddress(e)}}},[t._v(t._s(e.addressInfo.addressTxt))]):t._e()]})],2)]):t._e()]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowSearchBlock,expression:"isShowSearchBlock"}],staticClass:"search-address-list"},t._l(t.searchResList,function(e,i){return s("div",{key:i,staticClass:"item",on:{click:function(s){t.confirmSearchAddress(e)}}},[s("div",{staticClass:"address"},[s("div",{staticClass:"title"},[t._v(t._s(e.title))]),s("div",{staticClass:"detail"},[t._v(t._s(e.address))])]),s("div",{staticClass:"distance"},[t._v(t._s(e.distance)+t._s(e.distanceUnit))])])}))])},r=[],o=(s("rGqo"),s("ls82"),s("MECJ")),n=(s("f3/d"),s("yt8O"),s("VRzm"),s("uXAG")),a=s("Is5O"),c=s("+n12"),d={name:"",components:{},data:function(){return{isGetGeo:!1,gpsLatLng:{latitude:"",longitude:""},confirmedAddressInfo:{cityInfo:{cityName:"",defaultLat:"",defaultLng:"",isByLocation:null},addressInfo:{addressTxt:"",street:"",lat:"",lng:""}},selectedCityInfo:{},tempCityInfo:{},gpsStreetTxt:"",isShowSearchBlock:!1,searchTxt:"",isEntering:!1,searchResList:[],localStorageArr:[]}},created:function(){},mounted:function(){this.initCityInfo(),this.doQueryPlaceSearch(),this.getLocalStorageInfo(),this.keyboardFix(),this.DoQueryCityList(),this.sendPoint("page")},watch:{searchTxt:function(t,e){t?this.doQueryPlaceSearch():this.searchResList=[]}},beforeRouteEnter:function(t,e,s){console.log("Home_to:",t),console.log("Home_from:",e),s(function(t){sessionStorage.getItem("confirmedAddressInfo")&&(t.confirmedAddressInfo=JSON.parse(sessionStorage.getItem("confirmedAddressInfo"))),"Home"===e.name&&sessionStorage.getItem("confirmedAddressInfo")&&(t.gpsStreetTxt=t.confirmedAddressInfo.addressInfo.addressTxt)})},beforeRouteLeave:function(t,e,s){console.log("to:",t),console.log("from:",e),this.isShowSearchBlock?(this.isShowSearchBlock=!1,this.searchTxt="",this.$refs.addressInput.blur(),s(!1)):s()},methods:{getLatLng:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.tempCityInfo={},this.gpsStreetTxt="",!Object(c["b"])("lat")||!Object(c["b"])("lng")){t.next=7;break}this.gpsLatLng.latitude=Object(c["b"])("lat"),this.gpsLatLng.longitude=Object(c["b"])("lng"),t.next=20;break;case 7:return t.prev=7,n["b"].loading({duration:0,forbidClick:!0,loadingType:"spinner"}),t.next=11,Object(c["a"])();case 11:e=t.sent,n["b"].clear(),e&&e.lat&&e.lng?(this.gpsLatLng.latitude=e.lat,this.gpsLatLng.longitude=e.lng):Object(n["b"])("未获取到您的位置请，请手动切换城市和搜索"),t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](7),console.log("err:",t.t0),Object(n["b"])("未获取到您的位置请，请手动切换城市和搜索");case 20:this.gpsLatLng.latitude&&this.gpsLatLng.longitude&&this.doQueryAddressName(),this.sendPoint("resetLocation");case 22:case"end":return t.stop()}},t,this,[[7,16]])}));return function(){return t.apply(this,arguments)}}(),doQueryAddressName:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,s,i,r,o=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={latitude:this.gpsLatLng.latitude,longitude:this.gpsLatLng.longitude},s={},t.prev=2,n["b"].loading({duration:0,forbidClick:!0,loadingType:"spinner"}),t.next=6,Object(a["c"])(e);case 6:s=t.sent,n["b"].clear(),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),Object(n["b"])("服务异常，请稍后再试！");case 13:"0"===s.resultCode&&(i=s.resultData,this.tempCityInfo={cityName:i.addressComponent.city,defaultLat:this.gpsLatLng.latitude,defaultLng:this.gpsLatLng.longitude,isByLocation:!0},this.gpsStreetTxt=i.addressComponent.street_number||i.addressComponent.street||i.addressComponent.district,r={cityInfo:this.tempCityInfo,addressInfo:{addressTxt:i.address,street:this.gpsStreetTxt,lat:this.gpsLatLng.latitude,lng:this.gpsLatLng.longitude}},sessionStorage.setItem("confirmedAddressInfo",JSON.stringify(r)),setTimeout(function(){o.$router.go(-1)},300));case 14:case"end":return t.stop()}},t,this,[[2,10]])}));return function(){return t.apply(this,arguments)}}(),doQueryPlaceSearch:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,s,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.searchTxt){t.next=2;break}return t.abrupt("return",!1);case 2:return e=this.confirmedAddressInfo.cityInfo,s={cityName:e.cityName,keyWord:this.searchTxt,latitude:e.defaultLat,longitude:e.defaultLng},i={},t.prev=5,n["b"].loading({duration:0,forbidClick:!0,loadingType:"spinner"}),t.next=9,Object(a["g"])(s);case 9:i=t.sent,n["b"].clear(),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](5),Object(n["b"])("服务异常，请稍后再试！");case 16:if(this.searchTxt){t.next=19;break}return this.searchResList=[],t.abrupt("return",!1);case 19:"0"===i.resultCode&&(this.searchResList=i.resultData);case 20:case"end":return t.stop()}},t,this,[[5,13]])}));return function(){return t.apply(this,arguments)}}(),DoQueryCityList:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={},t.prev=1,t.next=4,Object(a["d"])();case 4:e=t.sent,t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](1);case 9:e&&"0"===e.resultCode&&(this.$store.commit("SET_RAW_CITYINFO",e.resultData),console.log("store.state.rawCityInfo:",this.$store.state.rawCityInfo));case 10:case"end":return t.stop()}},t,this,[[1,7]])}));return function(){return t.apply(this,arguments)}}(),initCityInfo:function(){sessionStorage.getItem("confirmedCityInfo")&&(this.tempCityInfo=JSON.parse(sessionStorage.getItem("confirmedCityInfo")))},confirmSearchAddress:function(t){var e={addressTxt:t.title,street:"",lat:t.location.lat,lng:t.location.lng,id:t.id};this.confirmedAddressInfo.addressInfo=e;var s=JSON.stringify(this.confirmedAddressInfo);sessionStorage.setItem("confirmedAddressInfo",s),this.setLocalStorageInfo(this.confirmedAddressInfo),this.isShowSearchBlock=!1,this.$router.back(),this.sendPoint("chooseSearchAdd")},confirmLocalAddress:function(t){this.confirmedAddressInfo=t;var e=JSON.stringify(this.confirmedAddressInfo);sessionStorage.setItem("confirmedAddressInfo",e),this.setLocalStorageInfo(this.confirmedAddressInfo),this.$router.back(),this.sendPoint("chooseLocalAdd")},confirmLocation:function(){this.confirmedCityInfo=this.tempCityInfo,sessionStorage.setItem("confirmedCityInfo",JSON.stringify(this.confirmedCityInfo)),this.$store.commit("SET_ADDRESSCHANGE",!0),this.$router.go(-1)},getLocalStorageInfo:function(){var t=localStorage.getItem("fe_location_liehudaojia");if(console.log("str:",JSON.parse(t)),t){var e=JSON.parse(t);this.localStorageArr=e}},setLocalStorageInfo:function(t){var e=this;console.log("setLocalStorageInfo",t);var s=this.localStorageArr;try{s.length&&(s.forEach(function(s,i){s&&s.addressInfo&&s.addressInfo.id===t.addressInfo.id&&e.localStorageArr.splice(i,1)}),s.length>=4&&this.localStorageArr.splice(3,1)),this.localStorageArr.unshift(t);var i=JSON.stringify(this.localStorageArr);localStorage.setItem("fe_location_liehudaojia",i)}catch(t){console.log("err:",t),this.localStorageArr=[],this.delLocalStorageInfo()}},delLocalStorageInfo:function(){this.localStorageArr=[],localStorage.removeItem("fe_location_liehudaojia"),this.sendPoint("delLocalAdd")},addressInputFocus:function(){this.isShowSearchBlock=!0,this.sendPoint("searchAddress")},addressInputBlur:function(){},doSearchAddress:function(){this.isShowSearchBlock=!0},goAddressCity:function(){this.$router.push({name:"AddressCity",query:{}}),this.sendPoint("goCityChoose")},keyboardFix:function(){var t=this;document.addEventListener("touchstart",function(e){t.$refs.addressInput.blur()},!1)},sendPoint:function(t,e){window.JPTrack.emit(["addressHome",t],e)}}},l=d,h=(s("PRiR"),s("KHd+")),u=Object(h["a"])(l,i,r,!1,null,"5e65e2a8",null);e["default"]=u.exports},nxHv:function(t,e,s){},rGqo:function(t,e,s){for(var i=s("yt8O"),r=s("DVgA"),o=s("KroJ"),n=s("dyZX"),a=s("Mukb"),c=s("hPIQ"),d=s("K0xU"),l=d("iterator"),h=d("toStringTag"),u=c.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},g=r(f),m=0;m<g.length;m++){var p,S=g[m],L=f[S],v=n[S],I=v&&v.prototype;if(I&&(I[l]||a(I,l,u),I[h]||a(I,h,S),c[S]=u,L))for(p in i)I[p]||o(I,p,i[p],!0)}}}]);
//# sourceMappingURL=8.8ae534d0.js.map